# Story 6.2: Police Public Key Encryption

**Epic:** 6 - Security & Production Readiness
**Status:** ‚ùå HIGH PRIORITY

## Description
Implement end-to-end encryption for captured images using police-provided public keys, ensuring only authorized law enforcement can decrypt footage. Images are encrypted on ESP32 before leaving the device, making them unreadable by Guard-e-loo operators, fulfilling GDPR and privacy requirements.

## Goals
- Police-only decryption (Guard-e-loo cannot access plaintext)
- Encryption happens on ESP32 device (before transmission)
- Support RSA or ECC public key encryption
- Key distribution via secure channel
- Emergency key revocation capability
- Compliance with GDPR Article 25 (privacy by design)

## Technical Implementation

### ESP32 Encryption
- Use ESP32 hardware crypto acceleration
- AES-256-GCM for image encryption (symmetric)
- RSA-2048 or ECC P-256 for key wrapping
- Encrypt AES key with police public key
- Include encrypted key + IV in image metadata

### Key Distribution
- Police provide public key certificates
- Keys stored on Pi gateway
- ESP32 fetches public key on boot
- Key cached locally (refreshed daily)
- Multiple keys supported (different jurisdictions)

### Encrypted Image Format
```
[Header: 128 bytes]
  - Version: 4 bytes
  - Police Key ID: 32 bytes
  - Encrypted AES Key: 256 bytes (RSA encrypted)
  - IV: 16 bytes
  - Metadata: JSON (timestamp, device_id, etc)
[Encrypted Image Data: variable]
  - AES-256-GCM encrypted JPEG
[Authentication Tag: 16 bytes]
```

## Acceptance Criteria
- [ ] Images encrypted on ESP32 before transmission
- [ ] AES-256-GCM with hardware acceleration
- [ ] Police public key fetched from Pi gateway
- [ ] Encrypted AES key wrapped with RSA/ECC
- [ ] Guard-e-loo operators cannot decrypt images
- [ ] Decryption tool for police (command-line utility)
- [ ] Key ID included in metadata
- [ ] Encryption adds <500ms per image
- [ ] Supports multiple police jurisdictions (multiple keys)
- [ ] Key rotation supported
- [ ] Compliance documentation for GDPR

## Dependencies
- Story 1.3 (ESP32 baseline)
- Story 3.4 (Image upload)
- Story 6.3 (Key management)
- mbedTLS on ESP32
- OpenSSL for police decryption tool
