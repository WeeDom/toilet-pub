# Story 3.4: Image Upload & Metadata Protocol

**Epic:** 3 - Device Communication Layer
**Status:** ❌ TODO

## Description
Define and implement a standardized protocol for ESP32-CAM devices to upload captured images to the Raspberry Pi with associated metadata (timestamp, motion score, device info, encryption status). Supports both real-time uploads and store-and-forward for offline scenarios.

## Goals
- Efficient JPEG upload via HTTP multipart
- Rich metadata (timestamp, motion score, GPS if available, encryption)
- Support for encrypted image uploads (Story 6.2)
- Store-and-forward when Pi offline
- Bandwidth optimization (compression, resolution selection)
- Image deduplication and lifecycle management

## Key Components
- HTTP multipart upload endpoint on Pi
- Metadata schema (JSON sidecar or EXIF tags)
- ESP32 image queue for offline buffering
- Pi image storage (organized by site/date/device)
- Thumbnail generation for dashboard
- Encryption wrapper (AES-256-GCM)

## Acceptance Criteria
- [ ] ESP32 uploads JPEG images via HTTP POST
- [ ] Metadata included in headers or multipart form
- [ ] Images stored on Pi with timestamp-based directory structure
- [ ] Store-and-forward queue handles up to 50 images
- [ ] Upload completes within 5 seconds per image
- [ ] Encrypted images use AES-256-GCM (Story 6.2)
- [ ] Thumbnails auto-generated for dashboard
- [ ] Old images auto-deleted after retention period

## Dependencies
- Story 3.2 (ESP32 ↔ Pi Communication)
- Story 4.3 (Store-forward)
- Story 6.2 (Encryption)
